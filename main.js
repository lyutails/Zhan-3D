(()=>{"use strict";var t=function(){function t(t,n){this.x=t,this.y=n}return t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.scale=function(t){return this.x*=t,this.y*=t,this},t.prototype.abs=function(){return Math.hypot(this.x,this.y)},t.prototype.clone=function(){return new t(this.x,this.y)},t}(),n=new(function(){function n(t){var n=this;this.lastAnimation=null,this.angle=0,this.points=[],this.rot=new DOMPoint,this.position=new DOMPoint;var e={};document.onkeyup=function(t){e[t.code]=!1},document.onkeydown=function(t){e[t.code]=!0},this.keys=e;for(var i=0;i<10;i+=1){var o=new DOMPoint(10*Math.random()-5,10*Math.random()-5,10*Math.random()+5);this.points.push({pos:o,angle:0})}var r=document.createElement("canvas");r.onmousemove=function(t){n.rot.x+=.01*t.movementX,n.rot.y+=.01*t.movementY},r.width=2500,r.height=1200;var s=r.getContext("2d");this.context=s,t.append(r),s.fillStyle="#c7375c",s.strokeStyle="#ffffff",s.lineWidth=3,s.fillRect(0,0,r.width,r.height);var h=[new DOMPoint(-1,-1,-1,1),new DOMPoint(1,-1,-1,1),new DOMPoint(1,1,-1,1),new DOMPoint(-1,1,-1,1),new DOMPoint(-1,-1,1,1),new DOMPoint(1,-1,1,1),new DOMPoint(1,1,1,1),new DOMPoint(-1,1,1,1)];this.vbuffer=h,this.ibuffer=[0,1,2,0,2,3,4,5,6,4,6,7,1,5,6,6,2,1,0,4,7,0,3,7,3,7,6,6,2,3,0,4,5,5,1,0]}return n.prototype.handleKey=function(){var t=new DOMPoint;this.keys.KeyW&&(t.y+=.1),this.keys.KeyA&&(t.x+=.1),this.keys.KeyS&&(t.y-=.1),this.keys.KeyD&&(t.x-=.1),this.position.x+=t.x,this.position.y+=t.y},n.prototype.cube=function(t,n,e){for(var i=this,o=this.context,r=(new DOMMatrix).translate(n.x,n.y,n.z).rotate(e,e,0),s=this.vbuffer.map((function(n){return i.transform(t,r,n)})),h=0;h<this.ibuffer.length;h+=3){var a=this.ibuffer[h],c=this.ibuffer[h+1],u=this.ibuffer[h+2];o.beginPath(),o.moveTo(s[a].x,s[a].y),o.lineTo(s[c].x,s[c].y),o.lineTo(s[u].x,s[u].y),o.lineTo(s[a].x,s[a].y),o.stroke(),o.closePath()}},n.prototype.transform=function(t,n,e){this.context;var i=this.context.canvas,o=t.multiply(n).transformPoint(e);return new DOMPoint((o.x/o.w*.5+.5)*i.width,(o.y/o.w*-.5+.5)*i.height)},n.prototype.render=function(){var n=this;this.handleKey();var e=this.context,i=this.context.canvas;new t(i.width/2,i.height/2),e.fillRect(0,0,i.width,i.height);var o,r,s,h,a,c=(o=Math.PI/2,r=i.width/i.height,1,1e3,s=[],h=Math.tan(.5*Math.PI-.5*o),a=1/-999,s[0]=h/r,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=h,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1001*a,s[11]=-1,s[12]=0,s[13]=0,s[14]=1e3*a*2,s[15]=0,new DOMMatrix(s)),u=(new DOMMatrix).translate(this.position.x,0,this.position.y).rotate(this.rot.y,this.rot.x);this.points.forEach((function(t,e){t.angle+=.1*e,n.cube(c.multiply(u),t.pos,t.angle)})),this.lastAnimation=requestAnimationFrame((function(){n.render()})),i.toDataURL()},n.prototype.start=function(){this.render()},n.prototype.stop=function(){cancelAnimationFrame(this.lastAnimation)},n}())(document.body);!function t(e){var i=function(t){var n=document.createElement("button");return n.textContent="move me WASD 3D",n.className="rotate_button",n.onclick=function(){t()},n}((function(){e?n.start():n.stop(),i.remove(),t(!e)}));document.body.append(i)}(!0)})();
//# sourceMappingURL=main.js.map